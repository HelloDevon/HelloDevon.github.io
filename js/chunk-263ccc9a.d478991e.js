(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-263ccc9a"],{"0a49":function(t,e,a){var i=a("9b43"),s=a("626a"),r=a("4bf8"),n=a("9def"),o=a("cd1c");t.exports=function(t,e){var a=1==t,c=2==t,d=3==t,l=4==t,u=6==t,p=5==t||u,g=e||o;return function(e,o,f){for(var m,h,v=r(e),y=s(v),S=i(o,f,3),I=n(y.length),b=0,G=a?g(e,I):c?g(e,0):void 0;I>b;b++)if((p||b in y)&&(h=S(m=y[b],b,v),t))if(a)G[b]=h;else if(h)switch(t){case 3:return!0;case 5:return m;case 6:return b;case 2:G.push(m)}else if(l)return!1;return u?-1:d||l?l:G}}},"0ccd":function(t,e,a){"use strict";a.r(e);a("20d6"),a("7f7f");var i={data:function(){return{id:null,GoodsTypeList:[],tabName:"noset",form:{StrategyName:"",GoodsList:[]},ruleValidate:{StrategyName:[{required:!0,message:"请输入价格策略名称",trigger:"blur"}]},query:{strategyId:"",typeId:"",isSetPrice:0,pageSize:null,pageIndex:null},page:null,goods:{noset:[],set:[]}}},created:function(){this.getGoodsTypeList(),this.getGoods(),this.$route.params.id&&(this.id=this.$route.params.id,this.form.Id=this.id,this.form.StrategyName=this.$route.params.name,this.editInit())},methods:{checkIn:function(t){return-1===this.goods.set.findIndex(function(e){return e.Id==t})},editInit:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$api("POST","/GoodsPriceStrateg/GetPriceStrategyGoodsList",{strategyId:this.id,typeId:e,isSetPrice:1,pageSize:50,pageIndex:1}).then(function(e){0===e.ErrorCode?t.goods.set=e.Data:t.$Notice.warning({title:"系统提示",desc:e.Message})})},getGoods:function(){var t=this;this.page?(this.query.pageSize=this.page.pageSize,this.query.pageIndex=++this.page.pageIndex):(this.query.pageSize=40,this.query.pageIndex=1),this.$api("POST","/GoodsPriceStrateg/GetPriceStrategyGoodsList",this.query).then(function(e){0===e.ErrorCode?(t.page?t.goods.noset=t.goods.noset.concat(e.Data):t.goods.noset=e.Data,t.page={pageCount:e.TotalPages,pageIndex:t.query.pageIndex,pageSize:t.query.pageSize}):t.$Notice.warning({title:"系统提示",desc:e.Message})})},onSelectChange:function(t){t[0].id?this.query.typeId=t[0].id:this.query.typeId="",this.page=null,this.getGoods(),this.id&&this.editInit(t[0].id)},getGoodsTypeList:function(){var t=this;this.$api("GET","/GoodsType/GetGoodsTypeListByOperator").then(function(e){if(0===e.ErrorCode){var a=e.Data.map(function(t){return{title:t.TypeName,id:t.Id}});t.GoodsTypeList=[{title:"全部类型",expand:!0,children:a}]}else t.$Notice.warning({title:"系统提示",desc:e.Message})})},save:function(){var t=this;this.$refs.formValidate.validate(function(e){if(e){var a="";a=t.$route.params.id?"/GoodsPriceStrateg/UpdatePriceStrategy":"/GoodsPriceStrateg/AddPriceStrategy",t.form.GoodsList=t.goods[t.tabName].filter(function(t){return!!t.SalePrice&&{GoodsId:t.Id,SalePrice:1*t.SalePrice}});var i=t.form.GoodsList.map(function(t){return{GoodsId:t.Id,SalePrice:1*t.SalePrice}});if(t.form.GoodsList=[].concat(i),!t.form.GoodsList.length)return void t.$Notice.warning({title:"系统提示",desc:"请设置商品价格"});t.$api("POST",a,t.form).then(function(e){0===e.ErrorCode?(t.$Notice.success({title:"系统提示",desc:"操作成功"}),t.id?t.editInit():setTimeout(function(){t.back()},500)):t.$Notice.warning({title:"系统提示",desc:e.Message})})}else t.$Notice.warning({title:"系统提示",desc:"请输入价格策略名称"})})},back:function(){this.$router.go(-1)}}},s=(a("18e9"),a("b988"),a("2877")),r=Object(s.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"contain"},[a("Form",{ref:"formValidate",attrs:{model:t.form,rules:t.ruleValidate,"label-width":120}},[a("FormItem",{attrs:{label:"价格策略名称",prop:"StrategyName"}},[a("Input",{attrs:{placeholder:"请输入价格策略名称"},model:{value:t.form.StrategyName,callback:function(e){t.$set(t.form,"StrategyName",e)},expression:"form.StrategyName"}})],1),a("div",{staticClass:"goods-contain clear"},[a("nav",{staticClass:"fl"},[a("Tree",{attrs:{data:t.GoodsTypeList},on:{"on-select-change":t.onSelectChange}})],1),a("div",{staticClass:"goods-tab fl"},[a("Tabs",{model:{value:t.tabName,callback:function(e){t.tabName=e},expression:"tabName"}},[a("TabPane",{attrs:{label:"未设置价格",name:"noset"}},[a("div",{staticClass:"wrap clear"},t._l(t.goods.noset,function(e,i){return a("div",{key:i},[t.checkIn(e.Id)?a("div",{staticClass:"item"},[a("img",{attrs:{src:e.GoodsImage}}),a("p",{staticClass:"name"},[t._v(t._s(e.GoodsName))]),a("div",{staticClass:"bar"},[a("div",{staticClass:"ipt clear"},[a("span",{staticClass:"fl"},[t._v("建议零售：")]),t._v(t._s(e.SuggestPrice)+"元\n                      ")]),a("div",{staticClass:"ipt clear"},[a("span",{staticClass:"fl"},[t._v("销售价格：")]),a("Input",{staticClass:"fl",style:{width:"70px"},attrs:{size:"small"},model:{value:e.SalePrice,callback:function(a){t.$set(e,"SalePrice",a)},expression:"it.SalePrice"}})],1)])]):t._e()])}),0),t.page&&t.page.pageIndex<t.page.pageCount?a("Button",{attrs:{type:"info",long:""},on:{click:t.getGoods}},[t._v("加载更多")]):t._e()],1),t.id?a("TabPane",{attrs:{label:"已设置价格",name:"set"}},[a("div",{staticClass:"wrap clear"},t._l(t.goods.set,function(e,i){return a("div",{key:i,staticClass:"item"},[a("img",{attrs:{src:e.GoodsImage}}),a("p",{staticClass:"name"},[t._v(t._s(e.GoodsName))]),a("div",{staticClass:"bar"},[a("div",{staticClass:"ipt clear"},[a("span",{staticClass:"fl"},[t._v("建议零售：")]),t._v(t._s(e.SuggestPrice)+"元\n                    ")]),a("div",{staticClass:"ipt clear"},[a("span",{staticClass:"fl"},[t._v("销售价格：")]),a("Input",{staticClass:"fl",style:{width:"70px"},attrs:{size:"small"},model:{value:e.SalePrice,callback:function(a){t.$set(e,"SalePrice",a)},expression:"it.SalePrice"}})],1)])])}),0)]):t._e()],1)],1)]),a("FormItem",[a("Button",{on:{click:t.back}},[t._v("返回")]),a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")])],1)],1)],1)])},[],!1,null,"6efc7afe",null);e.default=r.exports},1169:function(t,e,a){var i=a("2d95");t.exports=Array.isArray||function(t){return"Array"==i(t)}},"18e9":function(t,e,a){"use strict";var i=a("7dd7");a.n(i).a},"20d6":function(t,e,a){"use strict";var i=a("5ca1"),s=a("0a49")(6),r="findIndex",n=!0;r in[]&&Array(1)[r](function(){n=!1}),i(i.P+i.F*n,"Array",{findIndex:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(r)},"3abc":function(t,e,a){},"7dd7":function(t,e,a){},b988:function(t,e,a){"use strict";var i=a("3abc");a.n(i).a},cd1c:function(t,e,a){var i=a("e853");t.exports=function(t,e){return new(i(t))(e)}},e853:function(t,e,a){var i=a("d3f4"),s=a("1169"),r=a("2b4c")("species");t.exports=function(t){var e;return s(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!s(e.prototype)||(e=void 0),i(e)&&null===(e=e[r])&&(e=void 0)),void 0===e?Array:e}}}]);