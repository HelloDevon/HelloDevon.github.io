(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-182f5d4a"],{"0795":function(t,e,i){},"455e":function(t,e,i){"use strict";var s=i("0795");i.n(s).a},"85cf":function(t,e,i){"use strict";i.r(e);i("ac6a");var s={data:function(){return{modal_read:!1,modal_delete:!1,modal_confirm:!1,modal:!1,loading:!1,_selection:[],_post_selection:[],detailData:null,TypeList:[],data_sms:[],columns_sms:[{title:"消息类型",key:"NoticeTypeName",width:300},{title:"通知方式",slot:"action"}],data:[],columns:[{type:"selection",width:60,align:"center"},{title:"状态",slot:"IsRead",width:70,align:"center"},{title:"标题",key:"Title",width:260},{title:"消息内容",slot:"Content"},{title:"创建时间",key:"RecordTime",width:170}],query:{NoticeType:"",keywords:"",pageSize:null,pageIndex:null},page:null}},created:function(){this.getNoticeTypeList(),this.getNoticeList(),this.getNoticeSubscribeList()},methods:{getUserNotReadStationNoticeCount:function(){var t=this;this.$api("GET","/Notice/GetUserNotReadStationNoticeCount").then(function(e){0===e.ErrorCode&&t.$store.commit("setNoticeCount",e.Data)})},toRead:function(t){if(this.detailData=t,0===t.IsRead){var e=[];e.push(t),this._selection=[].concat(e),this.sign("read")}this.modal_read=!0},sign:function(t){if(this._selection)switch(this._post_selection=[].concat(this._selection),this._post_selection=this._post_selection.map(function(t){return t.Id}),t){case"delete":this.modal_delete=!0;break;case"not":this.changeNot();break;default:this.changeRead()}else this.$Notice.warning({title:"系统提示",desc:"请勾选需要操作的消息"})},del:function(){var t=this;this.$api("POST","/Notice/NoticeBathDelete",this._post_selection).then(function(e){0===e.ErrorCode?(t.modal_delete=!1,t.getNoticeList(),t.$Notice.success({title:"系统提示",desc:"操作成功"})):t.$Notice.warning({title:"系统提示",desc:e.Message})})},changeNot:function(){var t=this;this.$api("POST","/Notice/NoticeBathToNotRead",this._post_selection).then(function(e){0===e.ErrorCode?t.getNoticeList():t.$Notice.warning({title:"系统提示",desc:e.Message})})},changeRead:function(){var t=this;this.$api("POST","/Notice/NoticeBathToRead",this._post_selection).then(function(e){0===e.ErrorCode?t.getNoticeList():t.$Notice.warning({title:"系统提示",desc:e.Message})})},onSelectChangeTB:function(t){this._selection=t},onConfirm:function(){var t=this;this.$api("GET","/Notice/AllNoticeToRead").then(function(e){0===e.ErrorCode?(t.getNoticeList(),t.modal_confirm=!1,t.$Notice.success({title:"系统提示",desc:"操作成功"})):t.$Notice.warning({title:"系统提示",desc:e.Message})})},subHandle:function(){this.getNoticeSubscribeList(),this.modal=!0},getNoticeSubscribeList:function(){var t=this;this.$api("GET","/Notice/GetNoticeSubscribeList").then(function(e){0===e.ErrorCode?t.data_sms=e.Data:t.$Notice.warning({title:"系统提示",desc:e.Message})})},saveSub:function(){var t=this,e=[].concat(this.data_sms);e.forEach(function(t){delete t.NoticeTypeName}),this.$api("POST","/Notice/SaveNoticeSubscribe",e).then(function(e){0===e.ErrorCode?(t.modal=!1,t.$Notice.success({title:"系统提示",desc:"保存成功"})):t.$Notice.warning({title:"系统提示",desc:e.Message})})},search:function(){this.query.keywords.trim().length?(this.page=null,this.getNoticeList()):this.$Notice.warning({title:"系统提示",desc:"请输入搜索的关键字"})},getNoticeList:function(){var t=this;this.loading=!0,this.page?(this.query.pageSize=this.page.pageSize,this.query.pageIndex=this.page.pageIndex):(this.query.pageSize=10,this.query.pageIndex=1),this.$api("POST","/Notice/GetUserNoticeList",this.query).then(function(e){t.loading=!1,0===e.ErrorCode?(t.getUserNotReadStationNoticeCount(),t.data=e.Data,t.page={pageCount:e.TotalRecords,pageIndex:t.query.pageIndex,pageSize:t.query.pageSize}):t.$Notice.warning({title:"系统提示",desc:e.Message})})},onChange:function(t){this.page.pageIndex=1*t,this.getNoticeList()},onPageSizeChange:function(t){this.page.pageSize=1*t,this.getNoticeList()},getNoticeTypeList:function(){var t=this;this.$api("GET","/Notice/GetNoticeTypeList").then(function(e){if(0===e.ErrorCode){var i=e.Data.map(function(t){return{title:t.NoticeTypeName,id:t.NoticeType}});t.TypeList=[{title:"所有消息",expand:!0,children:i}]}else t.$Notice.warning({title:"系统提示",desc:e.Message})})},onSelectChange:function(t){"id"in t[0]?this.query.NoticeType=t[0].id:this.query.NoticeType="",this.page=null,this.getNoticeList()},updateColumns:function(t){this.columns=t}}},o=(i("455e"),i("2877")),a=Object(o.a)(s,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("Layout",[i("Sider",{attrs:{"hide-trigger":""}},[i("div",{staticClass:"classify clear"},[i("Tree",{attrs:{data:t.TypeList},on:{"on-select-change":t.onSelectChange}})],1)]),i("Content",{staticClass:"contain"},[i("div",{staticClass:"btn-bar clear"},[i("div",{staticClass:"fl"},[i("Button",{style:{marginRight:"6px"},attrs:{type:"info",icon:"md-mail-open"},on:{click:t.subHandle}},[t._v("消息订阅")]),i("Button",{style:{marginRight:"6px"},attrs:{type:"info",icon:"md-list-box"},on:{click:function(e){t.modal_confirm=!0}}},[t._v("全部标记已读")]),i("Dropdown",{style:{marginRight:"6px"}},[i("Button",[t._v("批量操作")]),i("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[i("DropdownItem",[i("div",{staticClass:"btn",on:{click:function(e){return t.sign("read")}}},[t._v("标记为已读")])]),i("DropdownItem",[i("div",{staticClass:"btn",on:{click:function(e){return t.sign("not")}}},[t._v("标记为未读")])]),i("DropdownItem",[i("div",{staticClass:"btn",on:{click:function(e){return t.sign("delete")}}},[t._v("删除")])])],1)],1),i("Button",{attrs:{icon:"md-refresh"},on:{click:t.getNoticeList}},[t._v("刷新")])],1),i("div",{staticClass:"fr"},[i("Input",{staticStyle:{width:"200px"},style:{marginRight:"6px"},attrs:{placeholder:"请输入消息标题、消息内容搜索"},model:{value:t.query.keywords,callback:function(e){t.$set(t.query,"keywords",e)},expression:"query.keywords"}}),i("Button",{on:{click:t.search}},[t._v("搜索")]),i("FiltrateButton",{attrs:{columns:t.columns},on:{updateColumns:t.updateColumns}})],1)]),i("Table",{attrs:{loading:t.loading,border:"",columns:t.columns,data:t.data},on:{"on-row-click":t.toRead,"on-selection-change":t.onSelectChangeTB},scopedSlots:t._u([{key:"IsRead",fn:function(t){var e=t.row;return[i("div",{staticClass:"status"},[i("i",{staticClass:"iconfont",class:{iconxinfeng1:1===e.IsRead,iconxinfeng:0===e.IsRead}})])]}},{key:"Content",fn:function(e){var s=e.row;return[i("div",{staticClass:"not-content"},[t._v("\n            "+t._s(s.Content)+"\n          ")])]}}])}),t.page?i("iPage",{attrs:{pageSize:t.page.pageSize,current:t.page.pageIndex,total:t.page.pageCount},on:{onChange:t.onChange,onPageSizeChange:t.onPageSizeChange}}):t._e()],1)],1),i("Modal",{attrs:{title:"消息订阅设置",width:"600"},on:{"on-ok":t.saveSub},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[i("Table",{attrs:{border:"",columns:t.columns_sms,data:t.data_sms},scopedSlots:t._u([{key:"action",fn:function(e){e.row;var s=e.index;return[i("div",{staticClass:"wrap"},[i("Checkbox",{style:{marginRight:"38px"},model:{value:t.data_sms[s].IsStation,callback:function(e){t.$set(t.data_sms[s],"IsStation",e)},expression:"data_sms[index].IsStation"}},[t._v("站内信")]),i("Checkbox",{style:{marginRight:"38px"},model:{value:t.data_sms[s].IsSms,callback:function(e){t.$set(t.data_sms[s],"IsSms",e)},expression:"data_sms[index].IsSms"}},[t._v("短信")]),i("Checkbox",{model:{value:t.data_sms[s].IsWeiXin,callback:function(e){t.$set(t.data_sms[s],"IsWeiXin",e)},expression:"data_sms[index].IsWeiXin"}},[t._v("微信")])],1)]}}])})],1),i("Modal",{attrs:{title:"系统提示"},on:{"on-ok":t.onConfirm},model:{value:t.modal_confirm,callback:function(e){t.modal_confirm=e},expression:"modal_confirm"}},[i("p",[t._v("确定要把所有消息标为已读吗?")])]),i("Modal",{attrs:{width:"360"},model:{value:t.modal_delete,callback:function(e){t.modal_delete=e},expression:"modal_delete"}},[i("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[i("Icon",{attrs:{type:"ios-information-circle"}}),i("span",[t._v("删除提示")])],1),i("div",{staticStyle:{"text-align":"center"}},[i("p",[t._v("是否确定要批量删除选中的消息吗?")]),i("p",[t._v("删除后将无法恢复")])]),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"error",size:"large",long:""},on:{click:t.del}},[t._v("确定删除")])],1)]),i("Modal",{attrs:{title:"消息详情",width:"500"},model:{value:t.modal_read,callback:function(e){t.modal_read=e},expression:"modal_read"}},[t.detailData?i("div",{staticClass:"msg_show"},[i("h6",[t._v(t._s(t.detailData.Title))]),i("p",[t._v(t._s(t.detailData.Content))])]):t._e()])],1)},[],!1,null,"e3823cc4",null);e.default=a.exports},ac6a:function(t,e,i){for(var s=i("cadf"),o=i("0d58"),a=i("2aba"),n=i("7726"),c=i("32e9"),l=i("84f2"),r=i("2b4c"),d=r("iterator"),u=r("toStringTag"),h=l.Array,g={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=o(g),m=0;m<p.length;m++){var f,_=p[m],N=g[_],S=n[_],v=S&&S.prototype;if(v&&(v[d]||c(v,d,h),v[u]||c(v,u,_),l[_]=h,N))for(f in s)v[f]||a(v,f,s[f],!0)}}}]);