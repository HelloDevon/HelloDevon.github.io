(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-c06b2258"],{"0ef6":function(t,s,e){"use strict";var i=e("5c6b");e.n(i).a},2272:function(t,s,e){},"5c6b":function(t,s,e){},"77dd":function(t,s,e){"use strict";e.r(s);e("8e6e"),e("456d"),e("ac6a");var i=e("bd86"),a=e("2f62"),n=e("310e"),o=e.n(n),l={props:["num","aisle","disabled"],watch:{aisle:function(t){this.list=t},disabled:function(t){this.abled=t}},components:{draggable:o.a},data:function(){return{list:[],abled:!1}},created:function(){this.list=this.aisle,this.abled=this.disabled},methods:{dele:function(t){this.list.splice(t,1)},onGroupsChange:function(){this.$emit("updateList")}}},c=(e("f0a9"),e("2877"));function r(t,s){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);s&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),e.push.apply(e,i)}return e}var d={components:{Goods:Object(c.a)(l,function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"item"},[e("draggable",{staticClass:"list-group",attrs:{disabled:t.abled,list:t.list,group:"goods"},on:{change:t.onGroupsChange}},t._l(t.list,function(s,i){return e("div",{key:i,staticClass:"list-group-item"},[e("div",{staticClass:"goods"},[e("em",{staticClass:"rownum"},[t._v(t._s(i+1))]),t.abled?t._e():e("Button",{staticClass:"dele",attrs:{size:"small",type:"error",shape:"circle",icon:"md-close-circle"},on:{click:function(s){return t.dele(i)}}}),s.GoodsId?e("div",{staticClass:"goods-contain"},[e("img",{attrs:{src:s.GoodsImage}}),e("p",{staticClass:"name"},[t._v(t._s(s.Name))]),e("div",{staticClass:"handle"},[e("div",{staticClass:"ipt clear"},[e("span",{staticClass:"label fl"},[t._v("容量")]),e("InputNumber",{staticClass:"fl",style:{width:"50px"},attrs:{size:"small",max:10,min:1},model:{value:s.Capacity,callback:function(e){t.$set(s,"Capacity",e)},expression:"it.Capacity"}})],1),e("div",{staticClass:"ipt clear"},[e("span",{staticClass:"label fl"},[t._v("预警")]),e("InputNumber",{staticClass:"fl",style:{width:"50px"},attrs:{size:"small",max:10,min:1},model:{value:s.WarningQty,callback:function(e){t.$set(s,"WarningQty",e)},expression:"it.WarningQty"}})],1)])]):t._e()],1)])}),0)],1)},[],!1,null,"2e2217e8",null).exports,draggable:o.a},computed:function(t){for(var s=1;s<arguments.length;s++){var e=null!=arguments[s]?arguments[s]:{};s%2?r(e,!0).forEach(function(s){Object(i.a)(t,s,e[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):r(e).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(e,s))})}return t}({},Object(a.b)(["god"])),data:function(){return{pattern:0,seleGoodsIndex:null,id:null,tab_index:0,index:null,modalDele:!1,modalReset:!1,isInit:!1,list:[],goods:[],cabinetList:[],form:{CabinetId:"",RowCount:"",RowColRelation:[],AisleDetails:[]},query:{goodsCodeName:"",typeId:""}}},created:function(){this.id=this.$route.params.id,this.getCabinetList(),this.getGoodsList()},methods:{rchange:function(t){2!=t&&(this.seleGoodsIndex=null)},addAisle:function(t){this.list[t].aisle.push({Capacity:null,GoodsId:null,GoodsImage:null,GoodsName:null,WarningQty:null}),this.$forceUpdate()},ext:function(t,s,e){var i={Capacity:null,GoodsId:null,GoodsImage:null,GoodsName:null,WarningQty:null};t>0?this.list[s].aisle.splice(e+1,0,i):this.list[s].aisle.splice(e,0,i),this.$forceUpdate()},replaceHandle:function(t,s){if(2===this.pattern)if(null===this.seleGoodsIndex)this.$Notice.warning({title:"系统提示",desc:"请先选择需要替换的商品"});else{var e=this.goods[this.seleGoodsIndex],i=this.list[t].aisle[s];i.GoodsImage=e.GoodsImage,i.GoodsId=e.GoodsId,i.GoodsName=e.GoodsName,this.$forceUpdate()}},seleGoods:function(t){2===this.pattern&&(this.seleGoodsIndex===t?this.seleGoodsIndex=null:this.seleGoodsIndex=t)},changeTab:function(t){t!==this.tab_index&&(this.getAisle(this.cabinetList[t].Id),this.tab_index=t)},updateList:function(){this.list=[].concat(JSON.parse(JSON.stringify(this.list)))},copyRow:function(t){var s=Object.assign({},this.list[t]);this.list.push(JSON.parse(JSON.stringify(s))),this.$forceUpdate()},getAisle:function(t){var s=this;this.$api("GET","/Aisle/GetAisleByCabinetId?id=".concat(t)).then(function(t){0===t.ErrorCode?t.Data&&t.Data.length?(s.isInit=!1,s.list=[],t.Data.map(function(t){s.list[t.AisleRow-1]||(s.list[t.AisleRow-1]={aisle:[]}),s.list[t.AisleRow-1].aisle[t.AisleCol-1]={GoodsId:t.GoodsId,GoodsName:t.GoodsName,GoodsImage:t.GoodsImage,Capacity:t.Capacity,WarningQty:t.WarningQty}}),s.$forceUpdate()):s.isInit=!0:s.$Notice.warning({title:"系统提示",desc:t.Message})})},getCabinetList:function(){var t=this;this.$api("GET","/Machine/GetCabinetListByMachineId?machineId=".concat(this.id)).then(function(s){0===s.ErrorCode?(t.cabinetList=s.Data,t.getAisle(t.cabinetList[0].Id)):t.$Notice.warning({title:"系统提示",desc:s.Message})})},getGoodsList:function(){var t=this;this.$api("POST","/Aisle/GetGoodsListByAisle",this.query).then(function(s){0===s.ErrorCode&&(t.goods=s.Data.map(function(t){return{AisleRow:"",AisleCol:"",GoodsId:t.Id,Capacity:2,WarningQty:2,GoodsImage:t.GoodsImage,GoodsName:t.GoodsName}}))})},add:function(){this.list.push({aisle:[]})},save:function(){var t=this;if(this.list.length){for(var s=0;s<this.list.length;s++){if(!this.list[s].aisle.length)return void this.$Notice.warning({title:"系统提示",desc:"请添加货道商品"})}var e=this.handleForm(this.list);this.form.AisleDetails=e,this.form.RowCount=this.list.length,this.form.CabinetId=this.cabinetList[this.tab_index].Id;var i=Object.assign({},this.form);this.$api("POST","/Aisle/AddAisleInitialize",i).then(function(s){0==s.ErrorCode?t.$Notice.success({title:"系统提示",desc:"保存成功"}):t.$Notice.warning({title:"系统提示",desc:s.Message})})}else this.$Notice.warning({title:"系统提示",desc:"请设置货柜"})},handleStep:function(t){this.index=t,this.modalDele=!0},deleStep:function(){this.list.splice(this.index,1),this.modalDele=!1},resetHandle:function(){this.modalReset=!0},reset:function(){this.list=[],this.modalReset=!1},handleForm:function(t){for(var s=this,e=[],i=function(i){var a=t[i].aisle;s.form.RowColRelation.push({Key:i+1,Value:a.length}),a.forEach(function(t,s){t.AisleRow=i+1,t.AisleCol=s+1,e.push(Object.assign({},t))}),e=[].concat(e)},a=0;a<t.length;a++)i(a);return e}}},u=(e("be4f"),e("0ef6"),Object(c.a)(d,function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("div",{staticClass:"contain clear"},[e("div",{staticClass:"l-contain fl"},[e("div",{staticClass:"tab"},t._l(t.cabinetList,function(s,i){return e("div",{key:i,staticClass:"tab-item",class:{on:t.tab_index===i},on:{click:function(s){return s.stopPropagation(),t.changeTab(i)}}},[t._v(t._s(s.CCode))])}),0),e("div",{staticClass:"box"},[e("draggable",{staticClass:"list-group",attrs:{tag:"div",list:t.list,handle:".handle"}},t._l(t.list,function(s,i){return e("div",{key:i,staticClass:"step-wrap"},[e("div",{staticClass:"step fl handle"},[e("span",{staticClass:"dele",on:{click:function(s){return t.handleStep(i)}}},[e("i",{staticClass:"iconfont iconshanchudise"})]),e("span",{staticClass:"num"},[t._v(t._s(i+1))]),e("div",{staticClass:"copy-btn",on:{click:function(s){return t.copyRow(i)}}},[t._v("复制")])]),e("div",{staticClass:"fl cl"},[e("Goods",{attrs:{num:s.aisle.length,aisle:s.aisle},on:{updateList:t.updateList}})],1)])}),0)],1),e("div",{staticClass:"box-handle clear"},[e("Button",{style:{marginRight:"12px"},attrs:{type:"warning"},on:{click:t.resetHandle}},[t._v("重置货柜")]),e("Button",{attrs:{type:"info"},on:{click:t.add}},[t._v("添加新行")]),e("Button",{staticClass:"fr",attrs:{type:"info"},on:{click:t.save}},[t._v("保存")])],1),0!==t.pattern?e("div",{staticClass:"Masked"},t._l(t.list,function(s,i){return e("div",{key:i,staticClass:"row-item"},[t._l(s.aisle,function(s,a){return e("div",{key:a,staticClass:"aisle-item",on:{click:function(s){return t.replaceHandle(i,a)}}},[2===t.pattern?e("i",{staticClass:"iconfont iconqiehuan replace"}):t._e(),1===t.pattern?e("div",{staticClass:"extend clear"},[e("i",{staticClass:"iconfont iconzuokuozhan fl",on:{click:function(s){return t.ext(-1,i,a)}}}),e("i",{staticClass:"iconfont iconyoukuozhan fr",on:{click:function(s){return t.ext(1,i,a)}}})]):t._e()])}),s.aisle.length?t._e():e("div",{staticClass:"aisle-item-empty"},[e("i",{staticClass:"iconfont icontianjia add-aisle",on:{click:function(s){return t.addAisle(i)}}})])],2)}),0):t._e()]),e("div",{staticClass:"r-contain fr"},[e("div",{staticClass:"search-box"},[e("RadioGroup",{style:{marginBottom:"12px"},on:{"on-change":t.rchange},model:{value:t.pattern,callback:function(s){t.pattern=s},expression:"pattern"}},[e("Radio",{attrs:{label:0}},[t._v("编辑模式")]),e("Radio",{attrs:{label:1}},[t._v("添加货道")]),e("Radio",{attrs:{label:2}},[t._v("添加商品")])],1),e("Input",{staticStyle:{width:"100%","margin-bottom":"6px"},attrs:{placeholder:"输入商品条码、名称"}}),e("Select",{staticStyle:{width:"100%","margin-bottom":"6px"}},t._l([],function(s){return e("Option",{key:s.value,attrs:{value:s.value}},[t._v(t._s(s.label))])}),1),e("Button",{attrs:{type:"info",long:""}},[t._v("搜索")])],1),e("div",{staticClass:"list-contain"},[e("draggable",{staticClass:"list-group",attrs:{sort:!1,list:t.goods,group:{name:"goods",pull:"clone",put:!1}}},t._l(t.goods,function(s,i){return e("div",{key:i,staticClass:"list-group-item",class:{seleGoods:t.seleGoodsIndex===i},on:{click:function(s){return t.seleGoods(i)}}},[e("div",{staticClass:"product-image"},[e("img",{attrs:{src:s.GoodsImage}})]),e("div",{staticClass:"product-info"},[e("div",[t._v(t._s(s.GoodsName))])])])}),0)],1)])]),e("Modal",{attrs:{width:"360"},model:{value:t.modalDele,callback:function(s){t.modalDele=s},expression:"modalDele"}},[e("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[e("Icon",{attrs:{type:"ios-information-circle"}}),e("span",[t._v("删除提示")])],1),e("div",{staticStyle:{"text-align":"center"}},[e("p",[t._v("是否确定要删除整行货道?")]),e("p",[t._v("删除后将无法恢复")])]),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"error",size:"large",long:""},on:{click:t.deleStep}},[t._v("确定删除")])],1)]),e("Modal",{attrs:{width:"360"},model:{value:t.modalReset,callback:function(s){t.modalReset=s},expression:"modalReset"}},[e("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[e("Icon",{attrs:{type:"ios-information-circle"}}),e("span",[t._v("删除提示")])],1),e("div",{staticStyle:{"text-align":"center"}},[e("p",[t._v("是否确定要重置整个货柜机?")]),e("p",[t._v("重置并保存后将无法恢复")])]),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"error",size:"large",long:""},on:{click:t.reset}},[t._v("确定")])],1)])],1)},[],!1,null,"0412063e",null));s.default=u.exports},be4f:function(t,s,e){"use strict";var i=e("2272");e.n(i).a},c861:function(t,s,e){},f0a9:function(t,s,e){"use strict";var i=e("c861");e.n(i).a}}]);