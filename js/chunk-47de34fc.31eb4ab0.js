(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-47de34fc"],{"24ce":function(e,t,s){"use strict";var i=s("65fd");s.n(i).a},"2fdb":function(e,t,s){"use strict";var i=s("5ca1"),r=s("d2c8");i(i.P+i.F*s("5147")("includes"),"String",{includes:function(e){return!!~r(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},5147:function(e,t,s){var i=s("2b4c")("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(s){try{return t[i]=!1,!"/./"[e](t)}catch(e){}}return!0}},"65fd":function(e,t,s){},6762:function(e,t,s){"use strict";var i=s("5ca1"),r=s("c366")(!0);i(i.P,"Array",{includes:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),s("9c6c")("includes")},aae3:function(e,t,s){var i=s("d3f4"),r=s("2d95"),o=s("2b4c")("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==r(e))}},d2c8:function(e,t,s){var i=s("aae3"),r=s("be13");e.exports=function(e,t,s){if(i(t))throw TypeError("String#"+s+" doesn't accept regex!");return String(r(e))}},d633:function(e,t,s){"use strict";s.r(t);s("6762"),s("2fdb");var i={data:function(){return{isShow:!1,permissions:[],permissionsM:[],form:{Name:"",Description:"",RolePermissions:[]},ruleValidate:{Name:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},roles:[{title:"全部",expand:!0,children:[]}],rolesM:[{title:"全部",expand:!0,children:[]}]}},created:function(){this.$route.params.id&&(this.form.RoleId=this.$route.params.id),this.$route.params.show&&(this.isShow=!0),this.getSysRoles()},methods:{editInit:function(){var e=this;this.$api("GET","/SysRoles/GetSysRolesInfo?roleId=".concat(this.form.RoleId)).then(function(t){0===t.ErrorCode?(e.form.Name=t.Data.Name,e.form.Description=t.Data.Description,e.form.RolePermissions=[].concat(t.Data.RolePermissionsList[0].RolePermissionsList,t.Data.RolePermissionsList[1].RolePermissionsList),e.roles[0].children=e.dataHandle([].concat(e.permissions),t.Data.RolePermissionsList[0].RolePermissionsList),e.rolesM[0].children=e.dataHandle([].concat(e.permissionsM),t.Data.RolePermissionsList[1].RolePermissionsList)):e.$Notice.warning({title:"系统提示",desc:t.Message})})},getSysRoles:function(){var e=this;this.$api("GET","/SysRoles/GetSysRolesMenus").then(function(t){0===t.ErrorCode?(e.permissions=t.Data.SysRolesList[0].MenuJson,e.permissionsM=t.Data.SysRolesList[1].MenuJson,e.form.RoleId?e.editInit():(e.roles[0].children=e.dataHandle(t.Data.SysRolesList[0].MenuJson),e.rolesM[0].children=e.dataHandle(t.Data.SysRolesList[1].MenuJson))):e.$Notice.warning({title:"系统提示",desc:t.message})})},back:function(){this.$router.back()},dataHandle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=[];for(var i in e){var r=e[i],o={expand:!0,title:r.Name,id:r.Id,checked:!(!t.includes(r.Id)||!t.length)};r.Children&&0!=r.Children.length&&(o.children=this.dataHandle(r.Children,t)),s.push(o)}return s},save:function(){var e=this,t=this.$refs.tree.getCheckedNodes().map(function(e){return e.id}),s=this.$refs.treeM.getCheckedNodes().map(function(e){return e.id});this.form.RolePermissions=[].concat(t,s),this.$refs.ruleValidate.validate(function(t){if(t){var s="/SysRoles/AddSysRolesInfo";e.form.RoleId&&(s="/SysRoles/UpdateSysRolesInfo"),e.$api("POST",s,e.form).then(function(t){0===t.ErrorCode?(e.form={Name:"",Description:"",RolePermissions:[]},e.$Notice.success({title:"系统提示",desc:"添加成功"})):e.$Notice.warning({title:"系统提示",desc:t.message})})}else e.$Notice.warning({title:"系统提示",desc:"请填写相关的信息"})})}}},r=(s("24ce"),s("2877")),o=Object(r.a)(i,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h6",{staticClass:"page-add clear"},[s("i",{staticClass:"iconfont icontianjia"}),e._v(" 编辑角色 "),s("Button",{staticClass:"fr",attrs:{icon:"ios-undo"},on:{click:e.back}},[e._v("返回")])],1),s("div",{staticClass:"section",style:{width:"80%"}},[s("Form",{ref:"ruleValidate",attrs:{"label-position":"center",model:e.form,rules:e.ruleValidate,"label-width":80}},[s("FormItem",{attrs:{label:"角色名称",prop:"Name"}},[s("Input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.form.Name,callback:function(t){e.$set(e.form,"Name",t)},expression:"form.Name"}})],1),s("FormItem",{attrs:{label:"角色描述"}},[s("Input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:4},placeholder:"请输入角色描述，比如该角色的用处或拥有的权限"},model:{value:e.form.Description,callback:function(t){e.$set(e.form,"Description",t)},expression:"form.Description"}})],1),s("FormItem",{staticClass:"clear",attrs:{label:"角色权限"}},[s("Card",{staticClass:"fl",style:{marginRight:"24px"},attrs:{"dis-hover":""}},[s("p",{attrs:{slot:"title"},slot:"title"},[e._v("PC角色权限")]),s("div",{staticClass:"role-menu",style:{minHeight:"300px",width:"400px"}},[s("Tree",{ref:"tree",attrs:{data:e.roles,"show-checkbox":""}})],1)]),s("Card",{staticClass:"fl",attrs:{"dis-hover":""}},[s("p",{attrs:{slot:"title"},slot:"title"},[e._v("小程序角色权限")]),s("div",{staticClass:"role-menu",style:{minHeight:"300px",width:"400px"}},[s("Tree",{ref:"treeM",attrs:{data:e.rolesM,"show-checkbox":""}})],1)])],1)],1),e.isShow?e._e():s("div",{staticClass:"handle clear"},[s("Button",{style:{marginRight:"14px"},on:{click:e.back}},[e._v("返回")]),s("Button",{attrs:{type:"info"},on:{click:e.save}},[e._v("保存")])],1)],1)])},[],!1,null,"e7708912",null);t.default=o.exports}}]);