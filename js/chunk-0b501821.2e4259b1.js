(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0b501821"],{"09f6":function(t,e,i){},"0a49":function(t,e,i){var o=i("9b43"),l=i("626a"),s=i("4bf8"),a=i("9def"),r=i("cd1c");t.exports=function(t,e){var i=1==t,n=2==t,d=3==t,c=4==t,u=6==t,m=5==t||u,f=e||r;return function(e,r,C){for(var h,p,v=s(e),M=l(v),b=o(r,C,3),g=a(M.length),F=0,I=i?f(e,g):n?f(e,0):void 0;g>F;F++)if((m||F in M)&&(p=b(h=M[F],F,v),t))if(i)I[F]=p;else if(p)switch(t){case 3:return!0;case 5:return h;case 6:return F;case 2:I.push(h)}else if(c)return!1;return u?-1:d||c?c:I}}},1169:function(t,e,i){var o=i("2d95");t.exports=Array.isArray||function(t){return"Array"==o(t)}},"20d6":function(t,e,i){"use strict";var o=i("5ca1"),l=i("0a49")(6),s="findIndex",a=!0;s in[]&&Array(1)[s](function(){a=!1}),o(o.P+o.F*a,"Array",{findIndex:function(t){return l(this,t,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")(s)},"679b":function(t,e,i){"use strict";var o=i("09f6");i.n(o).a},"89bb":function(t,e,i){"use strict";i.r(e);i("20d6");var o={data:function(){return{row:4,aisle:4,deleModal:!1,modal:!1,MModel:[],CModel:[],id:null,index:null,modelForm:{CCode:"",CModel:"",CSerialNo:"",Factory:"",AisleCount:"",AisleRowColList:[]},CabinetList:[],form:{MCode:"",MName:"",MModel:"",Uuid:"",CardNumber:"",CabinetList:[]},ruleValidateModel:{CCode:[{required:!0,message:"请输入机柜编号",trigger:"blur"}]},ruleValidate:{MCode:[{required:!0,message:"请输入设备编号",trigger:"blur"}],Uuid:[{required:!0,message:"请输入UUID",trigger:"blur"}],MName:[{required:!0,message:"请输入设备名称",trigger:"blur"}],MModel:[{required:!0,message:"请选择设备类型",trigger:"blur"}]}}},created:function(){this.getMModel(),this.getCModel(),this.$route.params.id&&(this.form.Id=this.$route.params.id,this.editInit(),this.getCabinetList())},methods:{editInit:function(){var t=this;this.$api("GET","/Machine/GetMachineById?id=".concat(this.form.Id)).then(function(e){0===e.ErrorCode&&(t.form=e.Data)})},MCodeBlur:function(){this.form.Uuid.length||(this.form.Uuid=this.form.MCode+"")},getCabinetList:function(){var t=this;this.$api("GET","/Machine/GetCabinetListByMachineId?machineId=".concat(this.form.Id)).then(function(e){0===e.ErrorCode&&(t.CabinetList=e.Data)})},getMModel:function(){var t=this;this.$api("GET","/Machine/GetMModelList").then(function(e){0===e.ErrorCode&&(t.MModel=e.Data)})},getCModel:function(){var t=this;this.$api("GET","/Machine/GetCModelList").then(function(e){0===e.ErrorCode&&(t.CModel=e.Data)})},getCM:function(t){var e=this.CModel.findIndex(function(e){return e.Id==t});return this.CModel[e].CModelName},rsInit:function(){for(var t=this.row,e=this.aisle,i=[],o=0;o<t;o++)i.push({RowNo:o+1,ColNum:1*e});this.modelForm.AisleRowColList=i},handle:function(){this.index=this.id=null,this.modelForm={CCode:"",CModel:"",CSerialNo:"",Factory:"",AisleCount:"",AisleRowColList:[]},this.modal=!0},back:function(){this.$router.go(-1)},addM:function(){var t=this;this.$refs.ruleValidateModel.validate(function(e){if(e&&t.modelForm.AisleRowColList.length)if(t.id)t.$api("POST","/Machine/UpdateCabinet",t.modelForm).then(function(e){0==e.ErrorCode?(t.$Notice.success({title:"系统提示",desc:"修改成功"}),t.CabinetList[t.index]=Object.assign({},t.modelForm),t.modal=!1):t.$Notice.warning({title:"系统提示",desc:e.Message})});else if(t.form.Id){var i=Object.assign({MachineId:t.form.Id},t.modelForm);t.$api("POST","/Machine/AddCabinet",i).then(function(e){0==e.ErrorCode?(t.getCabinetList(),t.$Notice.success({title:"系统提示",desc:"保存成功"}),t.modelForm={CCode:"",CModel:"",CSerialNo:"",Factory:"",AisleCount:"",AisleRowColList:[]},t.modal=!1):t.$Notice.warning({title:"系统提示",desc:e.Message})})}else null!=t.index?t.CabinetList[t.index]=t.modelForm:t.CabinetList.push(Object.assign({},t.modelForm)),t.$Notice.success({title:"系统提示",desc:"添加成功"}),t.index=null,t.id=null,t.modal=!1,t.modelForm={CCode:"",CModel:"",CSerialNo:"",Factory:"",AisleCount:"",AisleRowColList:[]};else t.$Notice.warning({title:"系统提示",desc:"请填写相关的信息"})})},save:function(){var t=this;this.$refs.ruleValidate.validate(function(e){if(e){var i="/Machine/AddMachine";t.form.Id?(delete t.form.CabinetList,i="/Machine/UpdateMachine"):t.form.CabinetList=[].concat(t.CabinetList),t.$api("POST",i,t.form).then(function(e){0==e.ErrorCode?(t.$Notice.success({title:"系统提示",desc:"保存成功"}),t.form.Id||t.back()):t.$Notice.warning({title:"系统提示",desc:e.Message})})}else t.$Notice.warning({title:"系统提示",desc:"请填写相关的信息"})})},del:function(){var t=this;this.id?this.$api("POST","/Machine/DeleteCabinet",{Id:this.id}).then(function(e){0===e.ErrorCode?(t.CabinetList.splice(t.index,1),t.$Notice.success({title:"系统提示",desc:"删除成功"})):t.$Notice.warning({title:"系统提示",desc:e.Message})}):this.CabinetList.splice(this.index,1)},remove:function(t){this.index=t,this.CabinetList[t].Id?this.id=this.CabinetList[t].Id:this.id=null,this.deleModal=!0},edit:function(t){var e=this;this.index=t,this.CabinetList[t].Id?(this.id=this.CabinetList[t].Id,this.$api("GET","/Machine/GetCabinetById?id=".concat(this.id)).then(function(t){0===t.ErrorCode&&(e.modelForm=t.Data,e.modal=!0)})):(this.id=null,this.modelForm=Object.assign({},this.CabinetList[t]),this.modal=!0)},aisleAdd:function(t){this.modelForm.AisleRowColList[t].ColNum++},aisleDele:function(t){this.modelForm.AisleRowColList[t].ColNum--}}},l=(i("679b"),i("2877")),s=Object(l.a)(o,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"info"},[i("Card",{style:{marginBottom:"30px"}},[i("p",{attrs:{slot:"title"},slot:"title"},[t._v("基本信息")]),i("div",{staticClass:"good-form"},[i("Form",{ref:"ruleValidate",attrs:{rules:t.ruleValidate,model:t.form,"label-position":"left","label-width":80}},[i("Row",{attrs:{gutter:30,type:"flex",justify:"end"}},[i("Col",{attrs:{span:"12"}},[i("FormItem",{attrs:{label:"设备编号",prop:"MCode"}},[i("Input",{attrs:{placeholder:"请输入设备编号"},on:{"on-blur":t.MCodeBlur},model:{value:t.form.MCode,callback:function(e){t.$set(t.form,"MCode",e)},expression:"form.MCode"}})],1)],1),i("Col",{attrs:{span:"12"}},[i("FormItem",{attrs:{label:"UUID",prop:"Uuid"}},[i("Input",{attrs:{placeholder:"请输入UUID"},model:{value:t.form.Uuid,callback:function(e){t.$set(t.form,"Uuid",e)},expression:"form.Uuid"}})],1)],1)],1),i("Row",{attrs:{gutter:30,type:"flex",justify:"end"}},[i("Col",{attrs:{span:"12"}},[i("FormItem",{attrs:{label:"设备型号",prop:"MModel"}},[i("Select",{attrs:{placeholder:"请选择设备型号"},model:{value:t.form.MModel,callback:function(e){t.$set(t.form,"MModel",e)},expression:"form.MModel"}},t._l(t.MModel,function(e,o){return i("Option",{key:o,attrs:{value:e.Id}},[t._v(t._s(e.MModelName))])}),1)],1)],1),i("Col",{attrs:{span:"12"}},[i("FormItem",{attrs:{label:"设备名称",prop:"MName"}},[i("Input",{attrs:{placeholder:"请输入设备名称"},model:{value:t.form.MName,callback:function(e){t.$set(t.form,"MName",e)},expression:"form.MName"}})],1)],1)],1)],1)],1)])],1),i("div",{staticClass:"section"},[i("div",{staticClass:"title clear"},[i("h6",{staticClass:"fl"},[t._v("机柜")]),i("Button",{staticClass:"fl",attrs:{type:"info",icon:"md-add"},on:{click:t.handle}},[t._v("添加机柜")])],1),i("div",{staticClass:"list clear"},t._l(t.CabinetList,function(e,o){return i("Card",{key:o,staticClass:"item-li"},[i("div",{staticClass:"des"},[i("p",[t._v("机柜编号："+t._s(e.CCode))]),i("P",[t._v("机柜类型："+t._s(t.getCM(e.CModel)))]),i("p",[t._v("机柜SN："+t._s(e.CSerialNo))]),i("p",[t._v("货道数量："+t._s(e.AisleCount))]),i("p",[t._v("生产厂商："+t._s(e.Factory))])],1),i("div",{staticClass:"btns clear"},[i("Button",{style:{marginRight:"12px"},attrs:{size:"small",type:"info"},on:{click:function(e){return t.edit(o)}}},[t._v("编辑")]),i("Button",{attrs:{size:"small",type:"error"},on:{click:function(e){return t.remove(o)}}},[t._v("删除")])],1)])}),1)]),i("div",{staticClass:"handle clear"},[i("Button",{style:{marginRight:"14px"},on:{click:t.back}},[t._v("返回")]),i("Button",{attrs:{type:"info"},on:{click:t.save}},[t._v("保存")])],1),i("Modal",{attrs:{width:"1024","footer-hide":!0,title:"机柜编辑"},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[i("div",{staticClass:"clear"},[i("Form",{ref:"ruleValidateModel",staticClass:"fl",style:{width:"370px"},attrs:{model:t.modelForm,rules:t.ruleValidateModel,"label-width":80}},[i("FormItem",{attrs:{label:"机柜编号",prop:"CCode"}},[i("Input",{attrs:{placeholder:"请输入机型名称"},model:{value:t.modelForm.CCode,callback:function(e){t.$set(t.modelForm,"CCode",e)},expression:"modelForm.CCode"}})],1),i("FormItem",{attrs:{label:"机柜型号"}},[i("Select",{attrs:{placeholder:"请选择机柜型号"},model:{value:t.modelForm.CModel,callback:function(e){t.$set(t.modelForm,"CModel",e)},expression:"modelForm.CModel"}},t._l(t.CModel,function(e,o){return i("Option",{key:o,attrs:{value:e.Id}},[t._v(t._s(e.CModelName))])}),1)],1),i("FormItem",{attrs:{label:"机柜序列号"}},[i("Input",{attrs:{placeholder:"请输入机型名称"},model:{value:t.modelForm.CSerialNo,callback:function(e){t.$set(t.modelForm,"CSerialNo",e)},expression:"modelForm.CSerialNo"}})],1),i("FormItem",{attrs:{label:"生产厂商"}},[i("Input",{attrs:{placeholder:"请输入机型名称"},model:{value:t.modelForm.Factory,callback:function(e){t.$set(t.modelForm,"Factory",e)},expression:"modelForm.Factory"}})],1),i("FormItem",{attrs:{label:"货道数量"}},[i("Input",{attrs:{placeholder:"请输入机型名称"},model:{value:t.modelForm.AisleCount,callback:function(e){t.$set(t.modelForm,"AisleCount",e)},expression:"modelForm.AisleCount"}})],1),i("FormItem",[i("Button",{attrs:{type:"primary"},on:{click:t.addM}},[t._v("保存")]),i("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){t.modal=!1}}},[t._v("取消")])],1)],1),i("div",{staticClass:"AisleRowColList fr"},[i("div",{staticClass:"ar-init clear"},[i("div",{staticClass:"clear"},[i("div",{staticClass:"fl",style:{marginRight:"20px"}},[i("span",[t._v("货道行数:")]),i("Input",{staticStyle:{width:"100px"},model:{value:t.row,callback:function(e){t.row=e},expression:"row"}})],1),i("div",{staticClass:"fl",style:{marginRight:"20px"}},[i("span",[t._v("货道列数:")]),i("Input",{staticStyle:{width:"100px"},model:{value:t.aisle,callback:function(e){t.aisle=e},expression:"aisle"}})],1),i("div",{staticClass:"fl"},[i("Button",{attrs:{type:"info"},on:{click:t.rsInit}},[t._v("生成")])],1)])]),t.modelForm.AisleRowColList.length?i("div",{staticClass:"ar-contain"},t._l(t.modelForm.AisleRowColList,function(e,o){return i("div",{key:o,staticClass:"row-item"},t._l(e.ColNum,function(e){return i("div",{key:e,staticClass:"aisle"},[i("span",{staticClass:"sign"},[t._v(t._s(o+1)+"-"+t._s(e))]),i("div",{staticClass:"col-handle"},[i("span",{on:{click:function(e){return t.aisleAdd(o)}}},[i("i",{staticClass:"iconfont icontianjia"})]),i("span",{on:{click:function(e){return t.aisleDele(o)}}},[i("i",{staticClass:"iconfont iconshanchujinzhi"})])])])}),0)}),0):t._e()])],1)]),i("Modal",{attrs:{width:"360"},model:{value:t.deleModal,callback:function(e){t.deleModal=e},expression:"deleModal"}},[i("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[i("Icon",{attrs:{type:"ios-information-circle"}}),i("span",[t._v("删除提示")])],1),i("div",{staticStyle:{"text-align":"center"}},[i("p",[t._v("是否确定要删除该机柜?")]),i("p",[t._v("删除后将无法恢复")])]),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"error",size:"large",long:""},on:{click:t.del}},[t._v("确定删除")])],1)])],1)},[],!1,null,"31febf4e",null);e.default=s.exports},cd1c:function(t,e,i){var o=i("e853");t.exports=function(t,e){return new(o(t))(e)}},e853:function(t,e,i){var o=i("d3f4"),l=i("1169"),s=i("2b4c")("species");t.exports=function(t){var e;return l(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!l(e.prototype)||(e=void 0),o(e)&&null===(e=e[s])&&(e=void 0)),void 0===e?Array:e}}}]);