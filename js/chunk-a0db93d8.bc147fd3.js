(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-a0db93d8"],{"0390":function(t,e,a){"use strict";var o=a("3778");a.n(o).a},"0a49":function(t,e,a){var o=a("9b43"),n=a("626a"),i=a("4bf8"),s=a("9def"),r=a("cd1c");t.exports=function(t,e){var a=1==t,l=2==t,u=3==t,d=4==t,c=6==t,f=5==t||c,m=e||r;return function(e,r,p){for(var I,h,g=i(e),v=n(g),y=o(r,p,3),b=s(v.length),C=0,w=a?m(e,b):l?m(e,0):void 0;b>C;C++)if((f||C in v)&&(h=y(I=v[C],C,g),t))if(a)w[C]=h;else if(h)switch(t){case 3:return!0;case 5:return I;case 6:return C;case 2:w.push(I)}else if(d)return!1;return c?-1:u||d?d:w}}},1169:function(t,e,a){var o=a("2d95");t.exports=Array.isArray||function(t){return"Array"==o(t)}},"20d6":function(t,e,a){"use strict";var o=a("5ca1"),n=a("0a49")(6),i="findIndex",s=!0;i in[]&&Array(1)[i](function(){s=!1}),o(o.P+o.F*s,"Array",{findIndex:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(i)},3175:function(t,e,a){"use strict";var o=a("01ea"),n={props:["pic","def","tip","w","h"],watch:{pic:function(t){this.picture=t}},data:function(){return{picture:"",defaultList:[],visible:!1,uploadList:[],action:"".concat(o.a.uploadUrl,"/upload")}},created:function(){this.picture=this.pic,this.defaultList=this.def},mounted:function(){this.uploadList=this.$refs.upload.fileList},methods:{getPic:function(){return this.picture},uploadFun:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.picture=e,setTimeout(function(){t.$nextTick(function(){t.uploadList=""!=e?[{name:(new Date).getTime()+"",percentage:100,status:"finished",uid:1*(new Date).getTime(),url:e}]:t.$refs.upload.fileList,t.$refs.upload.fileList=[]})},300)},handleView:function(){this.visible=!0},handleRemove:function(){this.$refs.upload.fileList=this.uploadList=[],this.picture=""},handleSuccess:function(t,e){e.url=this.picture=t.fullFilePath,e.name=(new Date).getTime()},handleFormatError:function(){this.$Notice.warning({title:"系统提示",desc:"文件格式不正确"})},handleMaxSize:function(){this.$Notice.warning({title:"系统提示",desc:"文件不能超过2M大小"})},handleBeforeUpload:function(t){var e=this;return new Promise(function(a,o){if(e.uploadList.length<2||(e.$Notice.warning({title:"图片超过上传限制"}),o()),e.w&&e.h){var n=new FileReader;n.onload=function(t){var n=t.target.result,i=new Image;i.onload=function(){var t=i.width,n=i.height;t==e.w|n==e.h?a():(e.$Notice.warning({title:"系统提示",desc:"文件尺寸不符合"}),o())},i.src=n},n.readAsDataURL(t)}else a()})}}},i=(a("0390"),a("2877")),s=Object(i.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],model:{value:t.picture,callback:function(e){t.picture=e},expression:"picture"}}),t._l(t.uploadList,function(e,o){return a("div",{key:o,staticClass:"demo-upload-list"},["finished"===e.status?[a("img",{attrs:{src:e.url}}),a("div",{staticClass:"demo-upload-list-cover"},[a("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(a){return t.handleView(e.name)}}}),a("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(a){return t.handleRemove(e)}}})],1)]:[e.showProgress?a("Progress",{attrs:{percent:e.percentage,"hide-info":""}}):t._e()]],2)}),a("Upload",{directives:[{name:"show",rawName:"v-show",value:!t.picture,expression:"!picture"}],ref:"upload",staticStyle:{display:"inline-block",width:"58px"},attrs:{"show-upload-list":!1,"default-file-list":t.defaultList,"on-success":t.handleSuccess,format:["jpg","jpeg","png"],"max-size":2028,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,"before-upload":t.handleBeforeUpload,multiple:"",type:"drag",action:t.action}},[a("div",{staticStyle:{width:"58px",height:"58px","line-height":"58px"}},[a("Icon",{attrs:{type:"ios-camera",size:"20"}})],1)]),a("Modal",{attrs:{title:"图片预览"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.visible?a("img",{staticStyle:{width:"100%"},attrs:{src:t.picture}}):t._e()]),a("p",{staticClass:"pic-tip"},[t._v(t._s(t.tip?t.tip:"仅支持png，大小小于2M"))])],2)},[],!1,null,"2cdaa432",null);e.a=s.exports},3778:function(t,e,a){},"4b89":function(t,e,a){"use strict";var o=a("6ce5");a.n(o).a},"6ce5":function(t,e,a){},cd1c:function(t,e,a){var o=a("e853");t.exports=function(t,e){return new(o(t))(e)}},e853:function(t,e,a){var o=a("d3f4"),n=a("1169"),i=a("2b4c")("species");t.exports=function(t){var e;return n(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!n(e.prototype)||(e=void 0),o(e)&&null===(e=e[i])&&(e=void 0)),void 0===e?Array:e}},f89c:function(t,e,a){"use strict";a.r(e);a("20d6");var o={components:{iUpload:a("3175").a},data:function(){return{spinShow:!1,loading:!1,modal:!1,ModelPicture:"",unitInfoIndex:null,editId:null,CustomImage_defaultList:[],DefaultImage_defaultList:[],columns:[{title:"计量单位",slot:"UnitId"},{title:"计量单位类型",slot:"UnitType"},{title:"换算率",key:"Rate"},{title:"操作",slot:"action"}],data:[],ruleValidate:{GoodsCode:[{required:!0,message:"请输入商品条码",trigger:"blur"}],GoodsName:[{required:!0,message:"请输入商品名称",trigger:"blur"}],TypeId:[{required:!0,message:"请选择商品类型",trigger:"blur"}]},ruleValidateUN:{UnitId:[{required:!0,message:"请选择计量单位",trigger:"blur"}],UnitType:[{required:!0,message:"请选择计量单位类型",trigger:"blur"}],Rate:[{required:!0,message:"请输入换算率",trigger:"blur"}]},goodsType:[],goodsInfo:{},unitInfo:{UnitId:"",UnitType:"",Rate:""},form:{GoodsCode:"",GoodsName:"",TypeId:"",Specs:"",BrandName:"",SubBrandName:"",Manufacturer:"",PackageType:"",DefaultImage:"",CustomImage:"",DefaultPrice:"",CustomPrice:"",GoodsLabels:"",ProposeSpring:"",GoodsUnitList:[]},searchTimer:null,goodsOpt:[]}},created:function(){this.getGoodsType(),this.getGoodsInfo(),this.$route.params.id&&(this.form.Id=this.editId=this.$route.params.id,this.editInit())},methods:{remoteMethod:function(t){var e=this;t.trim().length,this.searchTimer&&clearTimeout(this.searchTimer),this.searchTimer=setTimeout(function(){e.dimSearch(t)},800)},dimSearch:function(t){var e=this;this.$api("POST","/GoodsInfo/GetGoodsSearchList",{Search:t}).then(function(t){0===t.ErrorCode&&(e.goodsOpt=t.Data.map(function(t){return{value:t.GoodsCode,label:t.GoodsName}}))})},enter:function(){var t=this;this.form.GoodsCode.trim().length?(this.spinShow=!0,this.$api("GET","/GoodsInfo/GetGoodsInfoByCode?GoodsCode=".concat(this.form.GoodsCode)).then(function(e){if(t.spinShow=!1,0===e.ErrorCode){var a=Object.assign({},e.Data);delete a.GoodsUnitList,t.form=a,t.data=e.Data.GoodsUnitList.map(function(t){return{Id:t.Id,UnitId:t.UnitId,UnitType:t.UnitType,Rate:t.Rate}}),e.Data.CustomImage&&(t.$set(t.CustomImage_defaultList,0,{name:(new Date).getTime()+"",url:e.Data.CustomImage}),t.$refs.CustomImage.uploadFun(e.Data.CustomImage)),e.Data.DefaultImage&&(t.$set(t.DefaultImage_defaultList,0,{name:(new Date).getTime()+"",url:e.Data.DefaultImage}),t.$refs.DefaultImage.uploadFun(e.Data.DefaultImage))}else t.$Notice.warning({title:"系统提示",desc:e.Message})})):this.$Notice.warning({title:"系统提示",desc:"请输入商品条码"})},editInit:function(){var t=this;this.$api("GET","/GoodsInfo/GetGoodsInfoById?id=".concat(this.form.Id)).then(function(e){if(0===e.ErrorCode){var a=Object.assign({},e.Data);delete a.GoodsUnitList,t.form=a,t.data=e.Data.GoodsUnitList.map(function(t){return{Id:t.Id,UnitId:t.UnitId,UnitType:t.UnitType,Rate:t.Rate}}),e.Data.CustomImage&&(t.$set(t.CustomImage_defaultList,0,{name:(new Date).getTime()+"",url:e.Data.CustomImage}),t.$refs.CustomImage.uploadFun(e.Data.CustomImage)),e.Data.DefaultImage&&(t.$set(t.DefaultImage_defaultList,0,{name:(new Date).getTime()+"",url:e.Data.DefaultImage}),t.$refs.DefaultImage.uploadFun(e.Data.DefaultImage))}})},getGoodsType:function(){var t=this;this.$api("GET","/GoodsType/GetGoodsTypeListByOperator").then(function(e){0===e.ErrorCode&&(t.goodsType=e.Data)})},getGoodsInfo:function(){var t=this;this.$api("GET","/GoodsInfo/GetGoodsInfoById").then(function(e){0===e.ErrorCode&&(t.goodsInfo=e.Data)})},addMeasure:function(){this.unitInfoIndex=null,this.unitInfo={UnitId:"",UnitType:"2",Rate:"1"},this.modal=!0},edit:function(t){this.unitInfoIndex=t,this.unitInfo=this.data[t],this.unitInfo.GoodsId=this.form.Id,this.unitInfo.Rate=this.unitInfo.Rate+"",this.unitInfo.UnitType=this.unitInfo.UnitType+"",this.modal=!0},deleHandle:function(t){var e=this;this.data[t].Id?this.$api("GET","/GoodsInfo/DeleteGoodsUnitInfo?goodsUnitID=".concat(this.data[t].Id)).then(function(a){0===a.ErrorCode?(e.data.splice(t,1),e.$Notice.success({title:"系统提示",desc:"删除成功"})):e.$Notice.warning({title:"系统提示",desc:a.Message})}):this.data.splice(t,1)},back:function(){this.$router.back()},handle:function(){var t=this;this.data.length<2||null!==this.unitInfo?this.$refs.ruleValidateUN.validate(function(e){e?t.form.Id&&null!==t.editId?t.unitInfo.Id?t.$api("POST","/GoodsInfo/UpdateGoodsUnitInfo",t.unitInfo).then(function(e){0===e.ErrorCode?t.modal=!1:t.$Notice.warning({title:"系统提示",desc:e.Message})}):t.$api("POST","/GoodsInfo/AddGoodsUnitInfo",Object.assign({GoodsId:t.form.Id},t.unitInfo)).then(function(e){0===e.ErrorCode?(t.data.push(Object.assign({},t.unitInfo)),t.modal=!1):t.$Notice.warning({title:"系统提示",desc:e.Message})}):(null!==t.unitInfoIndex?t.$set(t.data,t.unitInfoIndex,t.unitInfo):t.data.push(Object.assign({},t.unitInfo)),t.detail_index=null,t.modal=!1):t.$Notice.warning({title:"系统提示",desc:"请填写相关的信息"})}):this.$Notice.warning({title:"系统提示",desc:"最多只能添加两个计量单位"})},getValue:function(t,e,a,o){var n=t.findIndex(function(t){return t[a]==e});return t[n][o]},save:function(){var t=this;this.$refs.ruleValidate.validate(function(e){if(e){var a="/GoodsInfo/AddGoodsInfo";t.form.Id&&null!==t.editId?a="/GoodsInfo/UpdateGoodsInfo":t.form.GoodsUnitList=t.data,t.form.DefaultImage=t.$refs.DefaultImage.getPic(),t.form.CustomImage=t.$refs.CustomImage.getPic(),t.$api("POST",a,t.form).then(function(e){0===e.ErrorCode?(t.$Notice.success({title:"系统提示",desc:"保存成功"}),null!==t.editId?t.back():(t.unitInfoIndex=null,t.editId=null,t.CustomImage_defaultList=[],t.DefaultImage_defaultList=[],t.data=[],t.unitInfo={UnitId:"",UnitType:"",Rate:""},t.form={GoodsCode:"",GoodsName:"",TypeId:"",Specs:"",BrandName:"",SubBrandName:"",Manufacturer:"",PackageType:"",DefaultImage:"",CustomImage:"",DefaultPrice:"",CustomPrice:"",GoodsLabels:"",ProposeSpring:"",GoodsUnitList:[]},t.$refs.CustomImage.uploadFun(),t.$refs.DefaultImage.uploadFun(),t.$refs.gc.focus())):t.$Notice.warning({title:"系统提示",desc:e.Message})})}else t.$Notice.warning({title:"系统提示",desc:"请填写相关的信息"})})}}},n=(a("4b89"),a("2877")),i=Object(n.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:{position:"relative"}},[a("h6",{staticClass:"page-add clear"},[a("i",{staticClass:"iconfont icontianjia"}),t._v(" 新增商品 "),a("Button",{staticClass:"fr",attrs:{icon:"ios-undo"},on:{click:t.back}},[t._v("返回")])],1),a("div",{staticClass:"info"},[a("Card",{style:{marginBottom:"30px"}},[a("p",{attrs:{slot:"title"},slot:"title"},[t._v("基本信息")]),a("div",{staticClass:"good-form"},[a("Form",{ref:"ruleValidate",attrs:{rules:t.ruleValidate,model:t.form,"label-position":"left","label-width":100}},[a("Row",{attrs:{gutter:100,type:"flex",justify:"end"}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"商品条码",prop:"GoodsCode"}},[a("Input",{ref:"gc",attrs:{placeholder:"请输入商品条码"},on:{"on-enter":t.enter},model:{value:t.form.GoodsCode,callback:function(e){t.$set(t.form,"GoodsCode",e)},expression:"form.GoodsCode"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"商品名称",prop:"GoodsName"}},[a("Input",{attrs:{placeholder:"请输入商品名称"},model:{value:t.form.GoodsName,callback:function(e){t.$set(t.form,"GoodsName",e)},expression:"form.GoodsName"}})],1)],1)],1),a("Row",{attrs:{gutter:100,type:"flex",justify:"end"}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"商品分类",prop:"TypeId"}},[a("Select",{attrs:{placeholder:"请选择商品分类"},model:{value:t.form.TypeId,callback:function(e){t.$set(t.form,"TypeId",e)},expression:"form.TypeId"}},t._l(t.goodsType,function(e,o){return a("Option",{key:o,attrs:{value:e.Id}},[t._v(t._s(e.TypeName))])}),1)],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"规格型号"}},[a("Input",{attrs:{placeholder:"请输入规格型号"},model:{value:t.form.Specs,callback:function(e){t.$set(t.form,"Specs",e)},expression:"form.Specs"}})],1)],1)],1),a("Row",{attrs:{gutter:100,type:"flex",justify:"end"}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"品牌名称"}},[a("Input",{attrs:{placeholder:"请输入品牌名称"},model:{value:t.form.BrandName,callback:function(e){t.$set(t.form,"BrandName",e)},expression:"form.BrandName"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"子品牌名称"}},[a("Input",{attrs:{placeholder:"请输入子品牌名称"},model:{value:t.form.SubBrandName,callback:function(e){t.$set(t.form,"SubBrandName",e)},expression:"form.SubBrandName"}})],1)],1)],1),a("Row",{attrs:{gutter:100,type:"flex",justify:"end"}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"生产厂家"}},[a("Input",{attrs:{placeholder:"请输入生产厂家"},model:{value:t.form.Manufacturer,callback:function(e){t.$set(t.form,"Manufacturer",e)},expression:"form.Manufacturer"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"包装类型"}},[a("Input",{attrs:{placeholder:"请输入包装类型"},model:{value:t.form.PackageType,callback:function(e){t.$set(t.form,"PackageType",e)},expression:"form.PackageType"}})],1)],1)],1),a("Row",{attrs:{gutter:100,type:"flex",justify:"end"}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"商品标签"}},[a("Input",{attrs:{placeholder:"请输入商品标签"},model:{value:t.form.GoodsLabels,callback:function(e){t.$set(t.form,"GoodsLabels",e)},expression:"form.GoodsLabels"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"建议货道"}},[a("Select",{attrs:{placeholder:"请选择货道"},model:{value:t.form.ProposeSpring,callback:function(e){t.$set(t.form,"ProposeSpring",e)},expression:"form.ProposeSpring"}},t._l([],function(e,o){return a("Option",{key:o,attrs:{value:e.TypeName}},[t._v(t._s(e.TypeName))])}),1)],1)],1)],1),a("Row",{attrs:{gutter:100,type:"flex",justify:"end"}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"商品默认价格"}},[a("Input",{attrs:{type:"number",placeholder:"请输入商品默认价格"},model:{value:t.form.DefaultPrice,callback:function(e){t.$set(t.form,"DefaultPrice",e)},expression:"form.DefaultPrice"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"自定义价格"}},[a("Input",{attrs:{type:"number",placeholder:"请输入自定义价格"},model:{value:t.form.CustomPrice,callback:function(e){t.$set(t.form,"CustomPrice",e)},expression:"form.CustomPrice"}})],1)],1)],1),a("Row",{attrs:{gutter:100,type:"flex",justify:"end"}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"商品默认图片"}},[a("iUpload",{ref:"DefaultImage",attrs:{pic:t.form.DefaultImage,tip:"支持.jpg.jpeg.png格式，尺寸为200*216px，小于2M",w:"200",h:"216",def:t.DefaultImage_defaultList}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"自定义图片"}},[a("iUpload",{ref:"CustomImage",attrs:{pic:t.form.CustomImage,tip:"支持.jpg.jpeg.png格式，尺寸为200*216px，小于2M",w:"200",h:"216",def:t.CustomImage_defaultList}})],1)],1)],1)],1)],1)])],1),a("div",{staticClass:"info"},[a("Card",{style:{marginBottom:"30px"}},[a("p",{attrs:{slot:"title"},slot:"title"},[t._v("计量单位    (最多只能添加两个计量单位)")]),a("div",{staticClass:"btn-bar clear",style:{marginBottom:"10px"}},[a("Button",{attrs:{type:"info",icon:"md-add"},on:{click:t.addMeasure}},[t._v("添加计量单位")])],1),a("div",{staticClass:"table-section"},[a("Table",{ref:"selection",attrs:{loading:t.loading,border:"",columns:t.columns,data:t.data},scopedSlots:t._u([{key:"UnitId",fn:function(e){var a=e.row;return e.index,[t._v("\n            "+t._s(t.getValue(t.goodsInfo.UnitList,a.UnitId,"Value","Name"))+"\n          ")]}},{key:"UnitType",fn:function(e){var a=e.row;return e.index,[t._v("\n            "+t._s(t.getValue(t.goodsInfo.UnitTypeList,a.UnitType,"Value","Name"))+"\n          ")]}},{key:"action",fn:function(e){e.row;var o=e.index;return[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"info",size:"small"},on:{click:function(e){return t.edit(o)}}},[t._v("编辑")]),a("Button",{attrs:{type:"error",size:"small"},on:{click:function(e){return t.deleHandle(o)}}},[t._v("删除")])]}}])})],1)])],1),a("div",{staticClass:"handle clear"},[a("Button",{style:{marginRight:"14px"},on:{click:t.back}},[t._v("返回")]),a("Button",{attrs:{type:"info"},on:{click:t.save}},[t._v("保存")])],1),a("Modal",{attrs:{width:"500","footer-hide":!0,title:"计量单位"},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[a("Form",{ref:"ruleValidateUN",attrs:{rules:t.ruleValidateUN,model:t.unitInfo,"label-width":100}},[a("FormItem",{attrs:{label:"计量单位",prop:"UnitId"}},[a("Select",{attrs:{placeholder:"请选择计量单位"},model:{value:t.unitInfo.UnitId,callback:function(e){t.$set(t.unitInfo,"UnitId",e)},expression:"unitInfo.UnitId"}},t._l(t.goodsInfo.UnitList,function(e,o){return a("Option",{key:o,attrs:{value:e.Value}},[t._v(t._s(e.Name))])}),1)],1),a("FormItem",{attrs:{label:"计量单位类型",prop:"UnitType"}},[a("Select",{attrs:{placeholder:"请选择计量单位类型"},model:{value:t.unitInfo.UnitType,callback:function(e){t.$set(t.unitInfo,"UnitType",e)},expression:"unitInfo.UnitType"}},t._l(t.goodsInfo.UnitTypeList,function(e,o){return a("Option",{key:o,attrs:{value:e.Value+""}},[t._v(t._s(e.Name))])}),1)],1),a("FormItem",{attrs:{label:"换算率",prop:"Rate"}},[a("Input",{attrs:{placeholder:"请输入换算率"},model:{value:t.unitInfo.Rate,callback:function(e){t.$set(t.unitInfo,"Rate",e)},expression:"unitInfo.Rate"}})],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:t.handle}},[t._v("保存")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){t.modal=!1}}},[t._v("取消")])],1)],1)],1),t.spinShow?a("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)},[],!1,null,"2389b306",null);e.default=i.exports}}]);