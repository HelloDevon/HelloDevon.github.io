(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-ea97767a"],{1:function(t,e){},1247:function(t,e,o){"use strict";var i=o("18bb");o.n(i).a},"18bb":function(t,e,o){},2:function(t,e){},3:function(t,e){},"3a1e":function(t,e,o){"use strict";o.r(e);o("7f7f");var i=o("1146"),n=o.n(i),a={data:function(){return{file:null,loadingStatus:!1,ModelPicture:!1,importModal:!1,inModal:!1,picture:null,id:null,TypeName:"",modal:!1,deleModal:!1,loading:!1,in_loading:!1,page:null,GoodsTypeList:[],query:{goodsCodeName:"",typeId:"",pageSize:null,pageIndex:null},columns:[{title:"商品图片",slot:"CustomImage",width:100},{title:"商品条码",key:"GoodsCode"},{title:"商品名称",key:"GoodsName"},{title:"品牌名称",key:"BrandName"},{title:"商品类型",key:"TypeName"},{title:"添加人",key:"RecordUserName",width:100},{title:"添加时间",key:"RecordTime",width:160},{title:"操作",slot:"action",width:200}],data:[],in_columns:[{type:"selection",width:60,align:"center"},{title:"商品",slot:"CustomImage",width:110},{title:"商品条码",key:"GoodsCode"},{title:"商品名称",key:"GoodsName"},{title:"品牌名称",key:"BrandName"}],in_data:[],inSearch:"",selection:[],outputs:[]}},created:function(){this.getGoods(),this.getGoodsTypeList()},mounted:function(){var t=this;this.$refs.upload.addEventListener("change",function(e){t.readExcel(e)})},methods:{importGoodsHandle:function(){var t=this;this.selection.length?this.$api("POST","/GoodsInfo/CopyCommodityStorehouseByGoodsInfo",{GoodsIdList:this.selection.map(function(t){return t.GoodsId})}).then(function(e){0===e.ErrorCode?(t.$Notice.success({title:"系统提示",desc:"添加成功"}),t.inModal=!1):t.$Notice.warning({title:"系统提示",desc:e.Message})}):this.$Notice.warning({title:"系统提示",desc:"请勾选需要添加的商品"})},inHandle:function(){this.inSearch="",this.in_data=[],this.selection=[],this.inModal=!0},onSelectChangeIn:function(t){this.selection=t},searchIn:function(){var t=this;this.inSearch.trim().length&&this.$api("POST","/GoodsInfo/GetCommodityStorehouseList",{Search:this.inSearch}).then(function(e){0===e.ErrorCode?t.in_data=e.Data:t.$Notice.warning({title:"系统提示",desc:e.Message})})},search:function(){this.query.goodsCodeName.trim().length?(this.page=null,this.getGoods()):this.$Notice.warning({title:"系统提示",desc:"请输入商品名称或商品条形码"})},handleUpload:function(t){return this.file=t,!1},EXCLEHandle:function(){this.importModal=!0},readExcel:function(t){var e=this,o=this,i=t.target.files;if(i.length<=0)return!1;if(!/\.(xls|xlsx)$/.test(i[0].name.toLowerCase()))return alert("上传格式不正确，请上传xls或者xlsx格式"),!1;var a=new FileReader;a.onload=function(t){try{var i=t.target.result,a=n.a.read(i,{type:"binary"}),s=a.SheetNames[0],l=n.a.utils.sheet_to_json(a.Sheets[s]);o.outputs=[];for(var r=0;r<l.length;r++){var d={address:l[r].addr,value:l[r].value};o.outputs.push(d)}o.importModal=!1,alert("共读取".concat(o.outputs.length,"条数据")),e.$refs.upload.value=""}catch(t){return!1}},a.readAsBinaryString(i[0])},openModelPicture:function(t){this.picture=t,this.ModelPicture=!0},updateColumns:function(t){this.columns=t},getGoods:function(){var t=this;this.loading=!0,this.page?(this.query.pageSize=this.page.pageSize,this.query.pageIndex=this.page.pageIndex):(this.query.pageSize=10,this.query.pageIndex=1),this.$api("POST","/GoodsInfo/GetGoodsInfoList",this.query).then(function(e){t.loading=!1,0===e.ErrorCode?(t.data=e.Data,t.page={pageCount:e.TotalRecords,pageIndex:t.query.pageIndex,pageSize:t.query.pageSize}):t.$Notice.warning({title:"系统提示",desc:e.Message})})},onChange:function(t){this.page.pageIndex=1*t,this.getGoods()},onPageSizeChange:function(t){this.page.pageSize=1*t,this.getGoods()},getGoodsTypeList:function(){var t=this;this.$api("GET","/GoodsType/GetGoodsTypeListByOperator").then(function(e){if(0===e.ErrorCode){var o=e.Data.map(function(t){return{title:t.TypeName,id:t.Id}});t.GoodsTypeList=[{title:"全部类型",expand:!0,children:o}]}else t.$Notice.warning({title:"系统提示",desc:e.Message})})},onSelectChange:function(t){t[0].id?this.query.typeId=t[0].id:this.query.typeId="",this.page=null,this.getGoods()},handle:function(t){this.$router.push("/product/list/handle/".concat(this.data[t].Id))},remove:function(t){this.id=this.data[t].Id,this.deleModal=!0},addGood:function(){this.$router.push("/product/list/handle")},openModal:function(){this.modal=!0},deleClass:function(){this.deleModal=!0},del:function(){var t=this;this.$api("post","/GoodsInfo/DeleteGoodsInfo",{Id:this.id}).then(function(e){t.deleModal=!1,0===e.ErrorCode?(t.page=null,t.getGoods()):t.$Notice.warning({title:"系统提示",desc:e.Message})})},asyncOK:function(){var t=this;if(!this.TypeName.trim().length)return this.$Notice.warning({title:"系统提示",desc:"请输入需要添加的商品类型名称"}),!0;this.$api("POST","/goods/AddGoodsType",{TypeName:this.TypeName}).then(function(e){t.modal=!1,200==e.code?t.$Notice.success({title:"系统提示",desc:"添加成功"}):t.$Notice.warning({title:"系统提示",desc:e.message})})}}},s=(o("1247"),o("2877")),l=Object(s.a)(a,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("Layout",[o("Sider",{attrs:{"hide-trigger":""}},[o("div",{staticClass:"classify clear"},[o("Tree",{attrs:{data:t.GoodsTypeList},on:{"on-select-change":t.onSelectChange}})],1)]),o("Content",{staticClass:"contain"},[o("div",{staticClass:"btn-bar clear"},[o("div",{staticClass:"fl"},[o("Button",{style:{marginRight:"6px"},attrs:{type:"info",icon:"md-add"},on:{click:t.addGood}},[t._v("新建")]),o("Button",{style:{marginRight:"6px"},attrs:{type:"info",icon:"md-list-box"},on:{click:t.inHandle}},[t._v("从商品库导入")]),o("Button",{style:{marginRight:"6px"},attrs:{type:"info",icon:"md-list-box"},on:{click:t.EXCLEHandle}},[t._v("导入")]),o("Button",{attrs:{icon:"md-refresh"},on:{click:t.getGoods}},[t._v("刷新")])],1),o("div",{staticClass:"fr"},[o("Input",{staticStyle:{width:"200px"},style:{marginRight:"6px"},attrs:{placeholder:"请输入商品名称、商品条形码搜索"},model:{value:t.query.goodsCodeName,callback:function(e){t.$set(t.query,"goodsCodeName",e)},expression:"query.goodsCodeName"}}),o("Button",{on:{click:t.search}},[t._v("搜索")]),o("FiltrateButton",{attrs:{columns:t.columns},on:{updateColumns:t.updateColumns}})],1)]),o("Table",{attrs:{loading:t.loading,border:"",columns:t.columns,data:t.data},scopedSlots:t._u([{key:"CustomImage",fn:function(e){var i=e.row;return e.index,[o("div",{staticClass:"CustomImage"},[o("img",{attrs:{src:i.CustomImage},on:{click:function(e){return t.openModelPicture(i.CustomImage)}}})])]}},{key:"action",fn:function(e){e.row;var i=e.index;return[o("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"info",size:"small"},on:{click:function(e){return t.handle(i)}}},[t._v("编辑")]),o("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"info",size:"small"},on:{click:function(e){return t.show(i)}}},[t._v("详情")]),o("Button",{attrs:{type:"error",size:"small"},on:{click:function(e){return t.remove(i)}}},[t._v("删除")])]}}])}),t.page?o("iPage",{attrs:{pageSize:t.page.pageSize,current:t.page.pageIndex,total:t.page.pageCount},on:{onChange:t.onChange,onPageSizeChange:t.onPageSizeChange}}):t._e(),o("Modal",{attrs:{width:"360",title:"添加商品分类"},on:{"on-ok":t.asyncOK},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[o("Input",{staticStyle:{width:"300px"},style:{margin:"0 auto",display:"block"},attrs:{size:"large",placeholder:"输入需要添加的商品类型名称..."},model:{value:t.TypeName,callback:function(e){t.TypeName=e},expression:"TypeName"}})],1),o("Modal",{attrs:{width:"360"},model:{value:t.deleModal,callback:function(e){t.deleModal=e},expression:"deleModal"}},[o("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[o("Icon",{attrs:{type:"ios-information-circle"}}),o("span",[t._v("删除提示")])],1),o("div",{staticStyle:{"text-align":"center"}},[o("p",[t._v("是否确定要删除此商品分类?")]),o("p",[t._v("删除后将无法恢复")])]),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{attrs:{type:"error",size:"large",long:""},on:{click:t.del}},[t._v("确定删除")])],1)]),o("Modal",{attrs:{width:"360"},model:{value:t.importModal,callback:function(e){t.importModal=e},expression:"importModal"}},[o("p",{staticStyle:{color:"#353535","text-align":"center"},attrs:{slot:"header"},slot:"header"},[o("span",[t._v("导入EXCLE文件")])]),o("div",{staticStyle:{"text-align":"center"}},[o("p",[t._v("支持EXCEL 2007/2010/2013/2016/2019的.xls/.xlsx文件格式")]),o("br"),o("Button",{attrs:{id:"EXCLE_BTN",icon:"md-folder-open",type:"primary",long:""}},[o("input",{ref:"upload",staticClass:"outputlist_upload",attrs:{type:"file",accept:".xls,.xlsx"}}),t._v("\n          选择导入EXCLE文件\n        ")])],1),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("a",{style:{display:"block"},attrs:{href:"/",download:"/template.xlsx"}},[o("Button",{attrs:{size:"large",long:""}},[t._v("模板下载")])],1)])]),o("Modal",{attrs:{title:"从商品库导入",width:"760"},model:{value:t.inModal,callback:function(e){t.inModal=e},expression:"inModal"}},[o("div",{staticClass:"btn-bar clear"},[o("div",{staticClass:"fr"},[o("Input",{staticStyle:{width:"200px"},style:{marginRight:"6px"},attrs:{placeholder:"请输入商品名称、商品条形码搜索"},model:{value:t.inSearch,callback:function(e){t.inSearch=e},expression:"inSearch"}}),o("Button",{on:{click:t.searchIn}},[t._v("搜索")])],1)]),o("Table",{attrs:{loading:t.in_loading,border:"",columns:t.in_columns,data:t.in_data},on:{"on-selection-change":t.onSelectChangeIn},scopedSlots:t._u([{key:"CustomImage",fn:function(e){var i=e.row;return e.index,[o("div",{staticClass:"CustomImage"},[o("img",{attrs:{src:i.CustomImage},on:{click:function(e){return t.openModelPicture(i.CustomImage)}}})])]}}])}),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{attrs:{type:"info",size:"large"},on:{click:t.importGoodsHandle}},[t._v("确定")])],1)],1)],1)],1),o("Modal",{staticClass:"ModelPicture_show",attrs:{width:"660"},model:{value:t.ModelPicture,callback:function(e){t.ModelPicture=e},expression:"ModelPicture"}},[o("img",{attrs:{src:t.picture}}),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{attrs:{type:"info"},on:{click:function(e){t.ModelPicture=!1}}},[t._v("关闭")])],1)])],1)},[],!1,null,"3a5e3176",null);e.default=l.exports}}]);