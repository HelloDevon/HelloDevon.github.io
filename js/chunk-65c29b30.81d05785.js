(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-65c29b30"],{"178b":function(e,t,a){"use strict";a.r(t);var i={data:function(){return{id:null,BuyDate:"",ruleValidate:{MachineCode:[{required:!0,message:"请输入设备编号",trigger:"blur"}],MachineName:[{required:!0,message:"请输入设备名称",trigger:"blur"}],BuyDate:[{required:!0,message:"请选择购入日期",trigger:"blur"}],PositionId:[{required:!0,message:"请选择点位",trigger:"change"}],PriceId:[{required:!0,message:"请选择价格策略",trigger:"change"}],PersonId:[{required:!0,message:"请选择补货员",trigger:"change"}],ReparePersonId:[{required:!0,message:"请选择维修员",trigger:"change"}]},form:{MachineId:this.$route.params.id,MachineCode:"",MachineName:"",BuyDate:"",PositionId:"",PriceId:"",MachinePerson:{PersonId:"",SMSNotification:!1,bSplitAccount:!1,SplitRatio:"",SplitLockDays:"",SplitMoney:""},MachineRepair:{ReparePersonId:"",SMSNotification:!1,bSplitAccount:!1,SplitRatio:"",SplitLockDays:"",SplitMoney:"",OfflineTimes:"",Temperature:""}},Positions:[],PriceStrategy:[],SysUser:[]}},created:function(){this.id=this.$route.params.id,this.getPositions(),this.getPriceStrategy(),this.getSysUser(),this.init()},methods:{init:function(){this.getOperatorMachineByMachine(),this.getMachinePositionByMachine(),this.getMachinePriceByMachine(),this.getMachinePersonByMachine(),this.getMachineRepairByMachine()},getOperatorMachineByMachine:function(){var e=this;this.$api("GET","/OperateConfig/GetOperatorMachineByMachineId?machineId=".concat(this.id)).then(function(t){0===t.ErrorCode&&(e.BuyDate=t.Data.BuyDate,e.form.BuyDate=t.Data.BuyDate,e.form.MachineCode=t.Data.MachineCode,e.form.MachineName=t.Data.MachineName)})},getMachinePositionByMachine:function(){var e=this;this.$api("GET","/OperateConfig/GetMachinePositionByMachineId?machineId=".concat(this.id)).then(function(t){0===t.ErrorCode&&(e.form.PositionId=t.Data.PositionId)})},getMachinePriceByMachine:function(){var e=this;this.$api("GET","/OperateConfig/GetMachinePriceByMachineId?machineId=".concat(this.id)).then(function(t){0===t.ErrorCode&&(e.form.PriceId=t.Data.PriceId)})},getMachinePersonByMachine:function(){var e=this;this.$api("GET","/OperateConfig/GetMachinePersonByMachineId?machineId=".concat(this.id)).then(function(t){if(0===t.ErrorCode){var a={PersonId:t.Data.PersonId,SMSNotification:t.Data.SMSNotification,bSplitAccount:t.Data.bSplitAccount,SplitRatio:t.Data.SplitRatio,SplitLockDays:t.Data.SplitLockDays,SplitMoney:t.Data.SplitMoney};e.form.MachinePerson=a}})},getMachineRepairByMachine:function(){var e=this;this.$api("GET","/OperateConfig/GetMachineRepairByMachineId?machineId=".concat(this.id)).then(function(t){if(0===t.ErrorCode){var a={ReparePersonId:t.Data.ReparePersonId,SMSNotification:t.Data.SMSNotification,bSplitAccount:t.Data.bSplitAccount,SplitRatio:t.Data.SplitRatio,SplitLockDays:t.Data.SplitLockDays,SplitMoney:t.Data.SplitMoney,OfflineTimes:t.Data.OfflineTimes,Temperature:t.Data.Temperature};e.form.MachineRepair=a}})},getPositions:function(){var e=this;this.$api("GET","/OperateConfig/GetOperatorPositions").then(function(t){0===t.ErrorCode&&(e.Positions=t.Data)})},getPriceStrategy:function(){var e=this;this.$api("GET","/OperateConfig/GetOperatorPriceStrategy").then(function(t){0===t.ErrorCode&&(e.PriceStrategy=t.Data)})},getSysUser:function(){var e=this;this.$api("GET","/OperateConfig/GetOperatorSysUser").then(function(t){0===t.ErrorCode&&(e.SysUser=t.Data)})},save:function(){var e=this;this.$refs.ruleValidate.validate(function(t){if(t){if(!e.form.MachinePerson.PersonId)return void e.$Notice.warning({title:"系统提示",desc:"请选择补货员"});if(!e.form.MachineRepair.ReparePersonId)return void e.$Notice.warning({title:"系统提示",desc:"请选择维修员"});e.form.MachinePerson.bSplitAccount||(e.form.MachinePerson.SplitRatio=e.form.MachinePerson.SplitLockDays=e.form.MachinePerson.SplitMoney=""),e.form.MachineRepair.bSplitAccount||(e.form.MachineRepair.SplitRatio=e.form.MachineRepair.SplitLockDays=e.form.MachineRepair.SplitMoney=""),e.$api("POST","/OperateConfig/AddOperateConfig",e.form).then(function(t){0==t.ErrorCode?e.$Notice.success({title:"系统提示",desc:"保存成功"}):e.$Notice.warning({title:"系统提示",desc:t.Message})})}else e.$Notice.warning({title:"系统提示",desc:"请填写相关的信息"})})},back:function(){this.$router.go(-1)},dateChange:function(e){this.form.BuyDate=e}}},o=(a("e0be"),a("2877")),r=Object(o.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Form",{ref:"ruleValidate",attrs:{rules:e.ruleValidate,model:e.form,"label-position":"left","label-width":100}},[a("div",{staticClass:"info"},[a("Card",{style:{marginBottom:"30px"}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("基本信息")]),a("div",{staticClass:"good-form"},[a("FormItem",{attrs:{label:"设备编号",prop:"MachineCode"}},[a("Input",{attrs:{maxlength:8,placeholder:"请输入设备编号"},model:{value:e.form.MachineCode,callback:function(t){e.$set(e.form,"MachineCode",t)},expression:"form.MachineCode"}})],1),a("FormItem",{attrs:{label:"设备名称",prop:"MachineName"}},[a("Input",{attrs:{placeholder:"请输入设备名称"},model:{value:e.form.MachineName,callback:function(t){e.$set(e.form,"MachineName",t)},expression:"form.MachineName"}})],1),a("FormItem",{attrs:{label:"购入日期",prop:"BuyDate"}},[a("DatePicker",{staticStyle:{width:"300px"},attrs:{value:e.BuyDate,type:"date",format:"yyyy-MM-dd",placeholder:"选择购入日期"},on:{"on-change":e.dateChange}})],1)],1)])],1),a("div",{staticClass:"info"},[a("Card",{style:{marginBottom:"30px"}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("策略配置")]),a("div",{staticClass:"good-form"},[a("FormItem",{attrs:{label:"点位",prop:"PositionId"}},[a("Select",{attrs:{placeholder:"请选择设备型号"},model:{value:e.form.PositionId,callback:function(t){e.$set(e.form,"PositionId",t)},expression:"form.PositionId"}},e._l(e.Positions,function(t,i){return a("Option",{key:i,attrs:{value:t.Id}},[e._v(e._s(t.Name))])}),1)],1),a("FormItem",{attrs:{label:"价格策略",prop:"PriceId"}},[a("Select",{attrs:{placeholder:"请选择设备型号"},model:{value:e.form.PriceId,callback:function(t){e.$set(e.form,"PriceId",t)},expression:"form.PriceId"}},e._l(e.PriceStrategy,function(t,i){return a("Option",{key:i,attrs:{value:t.Id}},[e._v(e._s(t.Name))])}),1)],1)],1)])],1),a("div",{staticClass:"info"},[a("Card",{style:{marginBottom:"30px"}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("补货配置")]),a("div",{staticClass:"good-form"},[a("FormItem",{attrs:{label:"补货员"}},[a("Select",{attrs:{placeholder:"请选择补货员"},model:{value:e.form.MachinePerson.PersonId,callback:function(t){e.$set(e.form.MachinePerson,"PersonId",t)},expression:"form.MachinePerson.PersonId"}},e._l(e.SysUser,function(t,i){return a("Option",{key:i,attrs:{value:t.Id}},[e._v(e._s(t.Name))])}),1)],1),a("Row",{attrs:{gutter:30}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"短信通知"}},[a("Checkbox",{model:{value:e.form.MachinePerson.SMSNotification,callback:function(t){e.$set(e.form.MachinePerson,"SMSNotification",t)},expression:"form.MachinePerson.SMSNotification"}},[e._v("缺货实时短信通知")]),a("Checkbox",{model:{value:e.form.MachinePerson.bSplitAccount,callback:function(t){e.$set(e.form.MachinePerson,"bSplitAccount",t)},expression:"form.MachinePerson.bSplitAccount"}},[e._v("补货员参与分账")])],1)],1)],1),e.form.MachinePerson.bSplitAccount?a("Row",{attrs:{gutter:30,type:"flex",justify:"end"}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"分账比例%"}},[a("Input",{attrs:{placeholder:"请设置分账比例%"},model:{value:e.form.MachinePerson.SplitRatio,callback:function(t){e.$set(e.form.MachinePerson,"SplitRatio",t)},expression:"form.MachinePerson.SplitRatio"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"分账锁定天数"}},[a("Input",{attrs:{placeholder:"请设置分账锁定天数"},model:{value:e.form.MachinePerson.SplitLockDays,callback:function(t){e.$set(e.form.MachinePerson,"SplitLockDays",t)},expression:"form.MachinePerson.SplitLockDays"}})],1)],1)],1):e._e(),e.form.MachinePerson.bSplitAccount?a("Row",{attrs:{gutter:30}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"分账金额上限"}},[a("Input",{attrs:{placeholder:"请设置分账金额上限"},model:{value:e.form.MachinePerson.SplitMoney,callback:function(t){e.$set(e.form.MachinePerson,"SplitMoney",t)},expression:"form.MachinePerson.SplitMoney"}})],1)],1)],1):e._e()],1)])],1),a("div",{staticClass:"info"},[a("Card",{style:{marginBottom:"30px"}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("维修配置")]),a("div",{staticClass:"good-form"},[a("FormItem",{attrs:{label:"维修员"}},[a("Select",{attrs:{placeholder:"请选择维修员"},model:{value:e.form.MachineRepair.ReparePersonId,callback:function(t){e.$set(e.form.MachineRepair,"ReparePersonId",t)},expression:"form.MachineRepair.ReparePersonId"}},e._l(e.SysUser,function(t,i){return a("Option",{key:i,attrs:{value:t.Id}},[e._v(e._s(t.Name))])}),1)],1),a("Row",{attrs:{gutter:30}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"短信通知"}},[a("Checkbox",{model:{value:e.form.MachineRepair.SMSNotification,callback:function(t){e.$set(e.form.MachineRepair,"SMSNotification",t)},expression:"form.MachineRepair.SMSNotification"}},[e._v("出现故障时短信通知")]),a("Checkbox",{model:{value:e.form.MachineRepair.bSplitAccount,callback:function(t){e.$set(e.form.MachineRepair,"bSplitAccount",t)},expression:"form.MachineRepair.bSplitAccount"}},[e._v("维修员参与分账")])],1)],1)],1),e.form.MachineRepair.bSplitAccount?a("Row",{attrs:{gutter:30,type:"flex",justify:"end"}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"分账比例%"}},[a("Input",{attrs:{placeholder:"请设置分账比例%"},model:{value:e.form.MachineRepair.SplitRatio,callback:function(t){e.$set(e.form.MachineRepair,"SplitRatio",t)},expression:"form.MachineRepair.SplitRatio"}})],1)],1),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"分账锁定天数"}},[a("Input",{attrs:{placeholder:"请设置分账锁定天数"},model:{value:e.form.MachineRepair.SplitLockDays,callback:function(t){e.$set(e.form.MachineRepair,"SplitLockDays",t)},expression:"form.MachineRepair.SplitLockDays"}})],1)],1)],1):e._e(),e.form.MachineRepair.bSplitAccount?a("Row",{attrs:{gutter:30}},[a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:"分账金额上限"}},[a("Input",{attrs:{placeholder:"请设置分账金额上限"},model:{value:e.form.MachineRepair.SplitMoney,callback:function(t){e.$set(e.form.MachineRepair,"SplitMoney",t)},expression:"form.MachineRepair.SplitMoney"}})],1)],1)],1):e._e(),a("FormItem",{staticClass:"clear",attrs:{label:"设备离线超过"}},[a("InputNumber",{staticClass:"fl",staticStyle:{width:"220px","margin-right":"14px"},attrs:{max:9e4,min:1,step:30,precision:0,placeholder:"请设置最大故障离线时间"},model:{value:e.form.MachineRepair.OfflineTimes,callback:function(t){e.$set(e.form.MachineRepair,"OfflineTimes",t)},expression:"form.MachineRepair.OfflineTimes"}}),a("span",{staticClass:"fl"},[e._v("(分钟)报警")])],1),a("FormItem",{staticClass:"clear",attrs:{label:"设备温度超过"}},[a("Input",{staticClass:"fl",staticStyle:{width:"220px","margin-right":"14px"},attrs:{placeholder:"请设置最大故障温度"},model:{value:e.form.MachineRepair.Temperature,callback:function(t){e.$set(e.form.MachineRepair,"Temperature",t)},expression:"form.MachineRepair.Temperature"}}),a("span",{staticClass:"fl"},[e._v("报警")])],1)],1)])],1)]),a("div",{staticClass:"handle clear"},[a("Button",{style:{marginRight:"14px"},on:{click:e.back}},[e._v("返回")]),a("Button",{attrs:{type:"info"},on:{click:e.save}},[e._v("保存")])],1)],1)},[],!1,null,"a6cd9354",null);t.default=r.exports},a7c2:function(e,t,a){},e0be:function(e,t,a){"use strict";var i=a("a7c2");a.n(i).a}}]);